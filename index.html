<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Irish Coast Guard - Doolin Unit - SAR VITALS</title>
<style>
body {
margin: 0;
font-family: Arial, sans-serif;
background: url('background.jpg') no-repeat center center fixed;
background-size: cover;
color: white;
text-align: center;
padding: 20px;
}
.overlay {
background: rgba(0, 0, 0, 0.7);
padding: 20px;
border-radius: 10px;
display: inline-block;
margin-top: 20px;
}
h1, h2 {
margin: 10px 0;
}
.widget {
margin: 15px auto;
padding: 15px;
background: rgba(255,255,255,0.15);
border-radius: 12px;
width: 320px;
text-align: center;
}
.icon {
font-size: 3rem;
margin: 10px 0;
}
#last-updated {
font-size: 0.8rem;
margin-top: 10px;
opacity: 0.8;
}
</style>
</head>
<body>
<div class="overlay">
<h1>Irish Coast Guard - Doolin Unit</h1>
<h2>SAR VITALS</h2>

<div class="widget">
<h3>ğŸŒ¤ï¸ Weather (Met Ã‰ireann)</h3>
<div class="icon" id="weather-icon">â³</div>
<div id="weather">Loading...</div>
</div>

<div class="widget">
<h3>ğŸŒŠ Tide (Lahinch Gauge)</h3>
<div class="icon">ğŸŒŠ</div>
<div id="tide">Loading...</div>
</div>

<div id="last-updated"></div>
</div>

<script>
const lat = 53.0166;
const lon = -9.3772;

async function fetchWeather() {
try {
const res = await fetch(`https://corsproxy.io/?https://prodapi.met.ie/weather/api/location/${lat}/${lon}/forecast/`);
const data = await res.json();

// Take first period (current/nearest forecast)
const current = data[0];

const temp = current.temperature;
const wind = current.windSpeed;
const condition = current.symbol; // icon code

document.getElementById("weather").innerText =
`${temp}Â°C | Wind ${wind} km/h`;

// Simple mapping of Met Eireann symbol codes to emojis
const icons = {
"sunny": "â˜€ï¸",
"partly-cloudy": "ğŸŒ¤ï¸",
"cloudy": "â˜ï¸",
"rain": "ğŸŒ§ï¸",
"showers": "ğŸŒ¦ï¸",
"thunder": "â›ˆï¸",
"snow": "â„ï¸"
};
document.getElementById("weather-icon").innerText =
icons[condition] || "ğŸŒ¡ï¸";

} catch (err) {
document.getElementById("weather").innerText = "Error fetching Met Ã‰ireann data.";
document.getElementById("weather-icon").innerText = "âš ï¸";
}
}

async function fetchTide() {
try {
const res = await fetch("https://corsproxy.io/?https://erddap.marine.ie/erddap/tabledap/IrelandTideGauge.json?time%2Cwaterlevel&station=Lahinch&orderBy(%22time%20desc%22)&limit=1");
const data = await res.json();
const latest = data.table.rows[0]; // [time, waterlevel]
const time = new Date(latest[0]).toLocaleTimeString();
const level = latest[1].toFixed(2);
document.getElementById("tide").innerText =
`${level} m at ${time}`;
} catch (err) {
document.getElementById("tide").innerText = "Error fetching tide data.";
}
}

function updateAll() {
fetchWeather();
fetchTide();
document.getElementById("last-updated").innerText =
"Last updated: " + new Date().toLocaleTimeString();
}

updateAll();
setInterval(updateAll, 5 * 60 * 1000); // refresh every 5 min
</script>
</body>
</html>
