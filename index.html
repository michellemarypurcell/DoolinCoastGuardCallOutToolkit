<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Doolin Coast Guard SAR Call Out Toolkit</title>
<style>
body {
font-family: Arial, sans-serif;
background: url('background.jpg') no-repeat top center fixed;
background-size: cover;
color: #fff;
text-align: center;
}
h1 {
color: #ffcc00;
background: rgba(0,0,0,0.6);
display: inline-block;
padding: 10px 20px;
border-radius: 8px;
}
.overlay {
position: fixed;
top: 0; left: 0; right: 0; bottom: 0;
background: rgba(0,0,0,0.4);
z-index: -1;
}
.widget {
border: 2px solid #ffcc00;
margin: 20px auto;
padding: 20px;
border-radius: 10px;
background: rgba(0,0,0,0.6);
max-width: 800px;
}
select, button {
padding: 10px;
font-size: 1.2em;
margin: 5px;
}
a { color: #ffcc00; }
</style>
</head>
<body>
<div class="overlay"></div>
<h1>Doolin Coast Guard SAR Call Out Toolkit</h1>

<div>
<label for="location">Select Location: </label>
<select id="location">
<option>DOOLIN</option>
<option>FANORE</option>
<option>BALLYVAUGHAN</option>
<option>KINVARA</option>
<option>KILFENORA</option>
<option>LISCANNOR</option>
<option>CLIFFS OF MOHER</option>
<option>LAHINCH</option>
<option>SPANISH POINT</option>
<option>WHITE STRAND</option>
<option>KILKEE</option>
<option>KILRUSH</option>
<option>QUILTY</option>
<option>GALWAY</option>
<option>DINGLE</option>
<option>TRALEE</option>
<option>FENIT</option>
</select>
<button onclick="updateData()">Update</button>
</div>

<div class="widget" id="weather">
<h2>Realtime Weather</h2>
<pre id="weatherData">Loading...</pre>
</div>

<div class="widget" id="tides">
<h2>Tidal Information</h2>
<pre id="tideData">Loading...</pre>
</div>

<div class="widget" id="news">
<h2>SAR News</h2>
<div id="newsData">Loading...</div>
</div>

<script>
const proxy = "https://corsproxy.io/?";

// Lookup table mapping towns to tide gauge + weather station
const stationLookup = {
"DOOLIN": { tide: "GALWAY_PORT", weather: "SHANNON_AIRPORT" },
"FANORE": { tide: "GALWAY_PORT", weather: "SHANNON_AIRPORT" },
"BALLYVAUGHAN": { tide: "GALWAY_PORT", weather: "SHANNON_AIRPORT" },
"KINVARA": { tide: "GALWAY_PORT", weather: "GALWAY_AIRPORT" },
"KILFENORA": { tide: "GALWAY_PORT", weather: "SHANNON_AIRPORT" },
"LISCANNOR": { tide: "GALWAY_PORT", weather: "SHANNON_AIRPORT" },
"CLIFFS OF MOHER": { tide: "GALWAY_PORT", weather: "SHANNON_AIRPORT" },
"LAHINCH": { tide: "GALWAY_PORT", weather: "SHANNON_AIRPORT" },
"SPANISH POINT":{ tide: "GALWAY_PORT", weather: "SHANNON_AIRPORT" },
"WHITE STRAND": { tide: "GALWAY_PORT", weather: "SHANNON_AIRPORT" },
"KILKEE": { tide: "KILRUSH", weather: "SHANNON_AIRPORT" },
"KILRUSH": { tide: "KILRUSH", weather: "SHANNON_AIRPORT" },
"QUILTY": { tide: "KILRUSH", weather: "SHANNON_AIRPORT" },
"GALWAY": { tide: "GALWAY_PORT", weather: "GALWAY_AIRPORT" },
"DINGLE": { tide: "VALENTIA", weather: "VALENTIA_OBSERVATORY" },
"TRALEE": { tide: "FENIT", weather: "VALENTIA_OBSERVATORY" },
"FENIT": { tide: "FENIT", weather: "VALENTIA_OBSERVATORY" }
};

async function updateData() {
const location = document.getElementById("location").value;
const station = stationLookup[location];

if (!station) return;

// Weather fetch
const weatherUrl = proxy + encodeURIComponent(`https://prodapi.metweb.ie/observations/${station.weather}`);
try {
const w = await fetch(weatherUrl);
const weather = await w.json();
document.getElementById("weatherData").textContent =
JSON.stringify(weather, null, 2);
} catch (err) {
document.getElementById("weatherData").textContent = "Error fetching weather data";
}

// Tide fetch
const tideUrl = proxy + encodeURIComponent(
`https://erddap.marine.ie/erddap/tabledap/I_NATIONAL_TIDE_GAUGE_NETWORK.json?station_id,sea_surface_height,time&station_id="${station.tide}"&time>=now-1day&time<=now+1day`
);
try {
const t = await fetch(tideUrl);
const tides = await t.json();
document.getElementById("tideData").textContent =
JSON.stringify(tides.table.rows.slice(-5), null, 2);
} catch (err) {
document.getElementById("tideData").textContent = "Error fetching tide data";
}

// SAR News fetch
const rssUrl = proxy + encodeURIComponent(
"https://rss2json.com/api.json?rss_url=https://news.google.com/rss/search?q=Irish+Coast+Guard+County+Clare+SAR"
);
try {
const n = await fetch(rssUrl);
const news = await n.json();
const html = news.items.slice(0,5)
.map(item => `<p><a href="${item.link}" target="_blank">${item.title}</a></p>`)
.join("");
document.getElementById("newsData").innerHTML = html;
} catch (err) {
document.getElementById("newsData").textContent = "Error fetching news data";
}
}

// Auto refresh every 1 minute
setInterval(updateData, 60000);

// Load initial data
updateData();
</script>
</body>
</html>
